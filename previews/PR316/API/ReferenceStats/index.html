<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ReferenceStats · CalibrateEDMF.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="CalibrateEDMF.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CalibrateEDMF.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../ReferenceModels/">ReferenceModels</a></li><li class="is-active"><a class="tocitem" href>ReferenceStats</a></li><li><a class="tocitem" href="../Pipeline/">Pipeline</a></li><li><a class="tocitem" href="../TurbulenceConvectionUtils/">TurbulenceConvectionUtils</a></li><li><a class="tocitem" href="../KalmanProcessUtils/">KalmanProcessUtils</a></li><li><a class="tocitem" href="../DistributionUtils/">DistributionUtils</a></li><li><a class="tocitem" href="../LESUtils/">LESUtils</a></li><li><a class="tocitem" href="../HelperFuncs/">HelperFuncs</a></li></ul></li><li><a class="tocitem" href="../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>ReferenceStats</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ReferenceStats</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/master/docs/src/API/ReferenceStats.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ReferenceStats"><a class="docs-heading-anchor" href="#ReferenceStats">ReferenceStats</a><a id="ReferenceStats-1"></a><a class="docs-heading-anchor-permalink" href="#ReferenceStats" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.ReferenceStatistics" href="#CalibrateEDMF.ReferenceStats.ReferenceStatistics"><code>CalibrateEDMF.ReferenceStats.ReferenceStatistics</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReferenceStatistics{FT &lt;: Real}</code></pre><p>A structure containing statistics from the reference model used to define a well-posed inverse problem.</p><p><strong>Fields</strong></p><ul><li><p><code>y::Vector{FT} where FT&lt;:Real</code></p><p>Reference data, length: <code>nSim * n_vars * n_zLevels</code> (possibly reduced by PCA)</p></li><li><p><code>Γ::Matrix{FT} where FT&lt;:Real</code></p><p>Data covariance matrix, dims: (y,y) (possibly reduced by PCA)</p></li><li><p><code>norm_vec::Array{Vector{FT}, 1} where FT&lt;:Real</code></p><p>Vector (length: <code>nSim</code>) of normalizing factors (length: <code>n_vars</code>)</p></li><li><p><code>pca_vec::Array{Union{LinearAlgebra.UniformScaling, Matrix{FT}}, 1} where FT&lt;:Real</code></p><p>Vector (length: <code>nSim</code>) of PCA projection matrices with leading eigenvectors as columns</p></li><li><p><code>y_full::Vector{FT} where FT&lt;:Real</code></p><p>Full reference data vector, length: <code>nSim * n_vars * n_zLevels</code></p></li><li><p><code>Γ_full::SparseArrays.SparseMatrixCSC{FT, Int64} where FT&lt;:Real</code></p><p>Full covariance matrix, dims: (y,y)</p></li></ul><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">ReferenceStatistics(y::Vector{FT}, args...) where {FT &lt;: Real}
ReferenceStatistics(
    RM::Vector{ReferenceModel};
    perform_PCA::Bool = true,
    normalize::Bool = true,
    variance_loss::FT = 0.1,
    tikhonov_noise::FT = 0.0,
    tikhonov_mode::String = &quot;absolute&quot;,
    dim_scaling::Bool = false,
    y_type::ModelType = LES(),
    Σ_type::ModelType = LES(),
    Δt::FT = 6 * 3600.0,
) where {FT &lt;: Real}</code></pre><p>Constructs the ReferenceStatistics defining the inverse problem.</p><p>Inputs:</p><ul><li><code>RM</code>               :: Vector of <code>ReferenceModel</code>s.</li><li><code>perform_PCA</code>      :: Boolean specifying whether to perform PCA.</li><li><code>normalize</code>        :: Boolean specifying whether to normalize the data.</li><li><code>variance_loss</code>    :: Fraction of variance loss when performing PCA.</li><li><code>tikhonov_noise</code>   :: Tikhonov regularization factor for covariance matrices.</li><li><code>tikhonov_mode</code>    :: If &quot;relative&quot;, tikhonov_noise is scaled by the maximum  eigenvalue in the covariance matrix considered, having the interpretation of  the inverse of the desired condition number. This value is enforced to be  larger than the sqrt of the machine precision for stability.</li><li><code>dim_scaling</code>      :: Whether to scale covariance blocks by their size.</li><li><code>y_type</code>           :: Type of reference mean data. Either LES() or SCM().</li><li><code>Σ_type</code>           :: Type of reference covariance data. Either LES() or SCM().</li><li><code>Δt</code>               :: [LES last time - SCM start time (LES timeframe)] for <code>LES_driven_SCM</code> cases.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L20-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.get_obs" href="#CalibrateEDMF.ReferenceStats.get_obs"><code>CalibrateEDMF.ReferenceStats.get_obs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_obs(
    m::ReferenceModel,
    y_names::Vector{String},
    Σ_names::Vector{String},
    normalize::Bool;
    z_scm::Union{Vector{FT}, Nothing} = nothing,
)
get_obs(
    m::ReferenceModel,
    y_type::Union{LES, SCM},
    Σ_type::Union{LES, SCM},
    normalize::Bool;
    z_scm::Union{Vector{FT}, Nothing},
)</code></pre><p>Get observations for variables <code>y_names</code>, interpolated to <code>z_scm</code> (if given), and possibly normalized with respect to the pooled variance.</p><p>Inputs:</p><ul><li><code>m</code>            :: Reference model</li><li><code>y_names</code>      :: Names of observed fields from the ReferenceModel <code>m</code>.</li><li><code>Σ_names</code>      :: Names of fields used to construct covariances, may be different than <code>y_names</code>  if there are LES/SCM name discrepancies.</li><li><code>normalize</code>    :: Whether to normalize the observations.</li><li><code>z_scm</code>        :: If given, interpolate LES observations to given levels.</li><li><code>y_type</code>       :: ModelType used to construct observations, ::LES or ::SCM.</li><li><code>y_type</code>       :: ModelType used to construct noise covariances, ::LES or ::SCM.</li></ul><p>Outputs:</p><ul><li><code>y</code>            :: Mean of observations, possibly interpolated to z_scm levels.</li><li><code>Σ</code>            :: Observational covariance matrix, possibly pool-normalized.</li><li><code>pool_var</code>     :: Vector of vertically averaged time-variance, one entry for each variable</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L149-L181">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.obs_PCA" href="#CalibrateEDMF.ReferenceStats.obs_PCA"><code>CalibrateEDMF.ReferenceStats.obs_PCA</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">obs_PCA(y_mean, y_var, allowed_var_loss = 1.0e-1)</code></pre><p>Perform dimensionality reduction using principal component analysis on the variance <code>y_var</code>. Only eigenvectors with eigenvalues that contribute to the leading 1-<code>allowed_var_loss</code> variance are retained. Inputs:</p><ul><li><code>y_mean</code>           :: Mean of the observations.</li><li><code>y_var</code>            :: Variance of the observations.</li><li><code>allowed_var_loss</code> :: Maximum variance loss allowed.</li></ul><p>Outputs:</p><ul><li><code>y_pca</code>            :: Projection of <code>y_mean</code> onto principal subspace spanned by eigenvectors.</li><li><code>y_var_pca</code>        :: Projection of <code>y_var</code> on principal subspace.</li><li><code>P_pca</code>            :: Projection matrix onto principal subspace, with leading eigenvectors as columns.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L212-L229">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.pca" href="#CalibrateEDMF.ReferenceStats.pca"><code>CalibrateEDMF.ReferenceStats.pca</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pca(covmat::AbstractMatrix{FT}, allowed_var_loss::FT) where {FT &lt;: Real}</code></pre><p>Perform dimensionality reduction using principal component analysis on the variance covmat.</p><p>Inputs:</p><ul><li><code>covmat</code>           :: Variance of the observations.</li><li><code>allowed_var_loss</code> :: Maximum variance loss allowed.</li></ul><p>Outputs:</p><ul><li><code>λ_pca</code>            :: Principal eigenvalues, ordered in increasing value order.</li><li><code>P_pca</code>            :: Projection matrix onto principal subspace, with leading eigenvectors as columns.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L238-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.pca_length" href="#CalibrateEDMF.ReferenceStats.pca_length"><code>CalibrateEDMF.ReferenceStats.pca_length</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Returns dimensionality of the ReferenceStatistics in low-dimensional latent space</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.full_length" href="#CalibrateEDMF.ReferenceStats.full_length"><code>CalibrateEDMF.ReferenceStats.full_length</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Returns full dimensionality of the ReferenceStatistics, before latent space encoding</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.get_profile" href="#CalibrateEDMF.ReferenceStats.get_profile"><code>CalibrateEDMF.ReferenceStats.get_profile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_profile(
    filename::String,
    y_names::Vector{String};
    ti::Real = 0.0,
    tf = nothing,
    z_scm::Union{Vector{FT}, Nothing} = nothing,
)
get_profile(m::ReferenceModel, filename::String; z_scm::Union{Vector{T}, T} = nothing) where {T}
get_profile(
    m::ReferenceModel,
    filename::String,
    y_names::Vector{String};
    z_scm::Union{Vector{T}, T} = nothing,
) where {T}</code></pre><p>Get time-averaged profiles for variables <code>y_names</code>, interpolated to <code>z_scm</code> (if given), and concatenated into a single output vector.</p><p>Inputs:</p><ul><li><code>filename</code>    :: nc filename</li><li><code>y_names</code>   :: Names of variables to be retrieved.</li><li><code>ti</code>          :: Initial time of averaging window.</li><li><code>tf</code>          :: Final time of averaging window.</li><li><code>z_scm</code>       :: If given, interpolate LES observations to given levels.</li><li><code>m</code>           :: ReferenceModel from which to fetch profiles, implicitly defines <code>ti</code> and <code>tf</code>. </li></ul><p>Outputs:</p><ul><li><code>y</code> :: Output vector used in the inverse problem, which concatenates the requested profiles.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L261-L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CalibrateEDMF.ReferenceStats.get_time_covariance" href="#CalibrateEDMF.ReferenceStats.get_time_covariance"><code>CalibrateEDMF.ReferenceStats.get_time_covariance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_time_covariance(m::ReferenceModel, y_names::Vector{String}; z_scm::Vector{FT}) where {FT &lt;: Real}</code></pre><p>Obtain the covariance matrix of a group of profiles, where the covariance is obtained in time.</p><p>Inputs:</p><ul><li><code>m</code>            :: Reference model.</li><li><code>y_names</code>    :: List of variable names to be included.</li><li><code>z_scm</code>        :: If given, interpolates covariance matrix to this locations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/CalibrateEDMF.jl/blob/bdf49d0a1e7be644ac8a8a86c90e9897342e3793/src/ReferenceStats.jl#L358-L368">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ReferenceModels/">« ReferenceModels</a><a class="docs-footer-nextpage" href="../Pipeline/">Pipeline »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Tuesday 19 April 2022 03:58">Tuesday 19 April 2022</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
